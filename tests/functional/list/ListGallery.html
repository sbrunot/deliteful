<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no"/>
	<meta name="apple-mobile-web-app-capable" content="yes"/>
	<title>Lists</title>

	<script type="text/javascript" src="../../../../delite/tests/boilerplate.js"></script>

	<script type="text/javascript">
		var ready = false;
		require([
		    "dcl/dcl",
			"dojo/on",
			"dojo/Deferred",
			"dojo/store/util/QueryResults",
			"dojo/store/Memory",
			"dojo/store/Observable",
			"delite/register",
			"deliteful/list/List"
		], function (dcl, on, Deferred, QueryResults, MemoryStore, Observable, register, List) {
  			var i, list;

  			globalStore = new Observable(MemoryStore({data: []}));
 
  			// Programmatic list: default store, items added before adding the list to the document and before startup
			list = register.createElement("d-list");
			list.id = "list-prog-1";
			list.pageLength = 20;
			list.style.height = "200px";
 			for (i = 0; i < 100; i++) {
				list.store.add({label: "Programmatic item of order " + i, righttext: list.id});
			}
			document.getElementById("list1Placeholder").appendChild(list);
			list.startup();

  			// Programmatic list: default store, items added after the list startup and after adding the list to the document
			list = register.createElement("d-list");
			list.id = "list-prog-2";
			list.style.height = "200px";
			list.startup();
			document.getElementById("list2Placeholder").appendChild(list);
  			for (i = 0; i < 100; i++) {
				list.store.add({label: "Programmatic item of order " + i, righttext: list.id});
			}

  			// Programmatic list: memory store, items added before adding the list to the document and before startup
			list = register.createElement("d-list");
			list.id = "list-prog-3";
			list.pageLength = 20;
			list.style.height = "200px";
			list.store = new Observable(new MemoryStore({data: [], idProperty: "label"}));
 			for (i = 0; i < 100; i++) {
				list.store.add({label: "Programmatic item of order " + i});
			}
			document.getElementById("list3Placeholder").appendChild(list);
			list.startup();
			

  			// Programmatic list: observable memory store, items added after the list startup and after adding the list to the document
			list = register.createElement("d-list");
			list.id = "list-prog-4";
			list.style.height = "200px";
			list.store = new Observable(new MemoryStore({data: [], idProperty: "label"}));
			list.startup();
			document.getElementById("list4Placeholder").appendChild(list);
  			for (i = 0; i < 100; i++) {
				list.store.add({label: "Programmatic item of order " + i});
			}

  			// Programmatic list: custom store with 500ms latency, using all items attribute and using delite/StoreMap mapping
			var CustomMemoryStore = dcl([MemoryStore], {
				latency: 500,
				query: dcl.superCall(function (sup) {
					return function (query, options) {
						var def = new Deferred;
						var that = this;
						setTimeout(function () {
							def.resolve(sup.call(that, query, options));
						}, this.latency);
						return new QueryResults(def);
					};
				})
			});
			var createStore = function (itemsCount, latency) {
				var i = 0, data = [];
				for (; i < itemsCount; i++) {
					data.push({id: 'ref' + i, text: 'this is list item ' + i});
				}
				return new Observable(new CustomMemoryStore({latency: latency, data: data, idProperty: 'id'}));
			};
			list = register.createElement("d-list");
			list.id = "list-prog-5";
			list.style.height = "200px";
			list.store = createStore(100, 500);
			list.labelAttr = "text";
			list.righttextFunc = function (item) {
				return "id: " + item.id;
			};
			list.iconFunc = function (item) {
				var i = parseInt(item.id.slice(3));
				return "../../images/i-icon-" + (i % 10 + 1) + ".png";
			};
			list.righticonFunc = function () {
				return "../../images/a-icon-1.png";
			};
			list.righticon2Func = function (item) {
				var i = parseInt(item.id.slice(3));
				return "../../images/b-icon-" + (i % 8 + 1) + ".png";
			};
			list.startup();
			document.getElementById("list5Placeholder").appendChild(list);
			
 			register.parse();


			document.getElementById("addButton").onclick = function () {
				var options = {}, beforeRenderer;
				var list = document.getElementById(document.getElementById("listId").value);
				var label = document.getElementById("labelInput").value;
				var righttext = document.getElementById("righttextInput").value;
				var item = {label: label, righttext: righttext};
				var index = document.getElementById("indexInput").value;
				index = index ? parseInt(index) : null;
				
				if (index !== null) {
					beforeRenderer = list.getItemRendererByIndex(index);
					if (beforeRenderer) {
						options.before = list.renderItemToItem(beforeRenderer.item); // there is a bug in delite/StoreMap, the method always return undefined
					}
				}
				
				list.store.add(item, options);
			};

			document.getElementById("removeButton").onclick = function () {
				var list = document.getElementById(document.getElementById("listId").value);
				var index = document.getElementById("indexInput").value;
				index = index ? parseInt(index) : null;
				list.store.remove(list.store.getIdentity(list.getItemRendererByIndex(index).item));
			};

			ready = true;
		});
	</script>
	<style>
		html {
			width: 100%;
			margin: 0;
			padding: 0;
		}
		
		body {
			font-family: Helvetica;
			font-size: 17px;
			background-color: #c5ccd3;
		}
	</style>
</head>
<body>
 	<input type="text" autofocus>
 	<br>
 	<h1>Programmatic lists</h1>
 	<h2>Default store, items added before adding the list to the document and before startup (id: list-prog-1)</h2>
 	<div id="list1Placeholder"></div>
 	<h2>Default store, items added after the list startup and after adding the list to the document (id: list-prog-2)</h2>
 	<div id="list2Placeholder"></div>
 	<h2>Memory store, items added before adding the list to the document and before startup (id: list-prog-3)</h2>
 	<div id="list3Placeholder"></div>
 	<h2>Observable Memory store, items added after the list startup and after adding the list to the document (id: list-prog-4)</h2>
 	<div id="list4Placeholder"></div>
 	<h2>Observable custom store with 500ms latency, using all items attribute and using delite/StoreMap mapping (id: list-prog-5)</h2>
 	<div id="list5Placeholder"></div>
    <h1>Markup lists</h1>
    <h2>10 items declared as markup, memory store, and selectionMode set to "multiple" (id: list-mark-1)</h2>
	<d-list id="list-mark-1" style="height: 200px" selectionMode="multiple" store="globalStore">
		<d-list-store>
			<d-list-store-item item="{label: 'list item 0', righttext: 'right text A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 1', righttext: 'right text B'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 2', righttext: 'right text C'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 3', righttext: 'right text D'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 4', righttext: 'right text E'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 5', righttext: 'right text F'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 6', righttext: 'right text G'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 7', righttext: 'right text H'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 8', righttext: 'right text I'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 9', righttext: 'right text J'}"></d-list-store-item>
		</d-list-store>
	</d-list>
    <h2>Non scrollable with 10 items declared as markup, default store, and selectionMode set to "single" (id: list-mark-2)</h2>
	<d-list id="list-mark-2" scrollDirection="none" selectionMode="single">
		<d-list-store>
			<d-list-store-item item="{label: 'list item 0', righttext: 'right text 1'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 1', righttext: 'right text 2'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 2', righttext: 'right text 3'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 3', righttext: 'right text 4'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 4', righttext: 'right text 5'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 5', righttext: 'right text 6'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 6', righttext: 'right text 7'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 7', righttext: 'right text 8'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 8', righttext: 'right text 9'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 9', righttext: 'right text 10'}"></d-list-store-item>
		</d-list-store>
	</d-list>
   	<h2>10 items declared as markup, default store, categorized (id: list-mark-3)</h2>
	<d-list id="list-mark-3" style="height: 200px" categoryAttr="righttext" righttextAttr="righttext">
		<d-list-store>
			<d-list-store-item item="{label: 'list item 0', righttext: 'A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 1', righttext: 'A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 2', righttext: 'A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 3', righttext: 'A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 4', righttext: 'A'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 5', righttext: 'B'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 6', righttext: 'B'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 7', righttext: 'B'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 8', righttext: 'B'}"></d-list-store-item>
			<d-list-store-item item="{label: 'list item 9', righttext: 'B'}"></d-list-store-item>
		</d-list-store>
	</d-list>
	<button onclick="var list = document.getElementById('list-mark-3'); list.categoryAttr = (list.categoryAttr === 'righttext' ? 'label' : 'righttext');">Toggle category attribute between righttext and label.</button>
   	<h2>10 items declared as markup, using all items attribute (id: list-mark-4)</h2>
	<d-list id="list-mark-4" style="height: 200px">
		<d-list-store>
			<d-list-store-item item="{icon: '../../images/i-icon-1.png', label: 'list item 0', righttext: 'A', righticon2: '../../images/b-icon-1.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-2.png', label: 'list item 1', righttext: 'A', righticon2: '../../images/b-icon-2.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-3.png', label: 'list item 2', righttext: 'A', righticon2: '../../images/b-icon-3.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-4.png', label: 'list item 3', righttext: 'A', righticon2: '../../images/b-icon-4.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-5.png', label: 'list item 4', righttext: 'A', righticon2: '../../images/b-icon-5.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-6.png', label: 'list item 5', righttext: 'B', righticon2: '../../images/b-icon-6.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-7.png', label: 'list item 6', righttext: 'B', righticon2: '../../images/b-icon-7.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-8.png', label: 'list item 7', righttext: 'B', righticon2: '../../images/b-icon-8.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-9.png', label: 'list item 8', righttext: 'B', righticon2: '../../images/b-icon-1.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
			<d-list-store-item item="{icon: '../../images/i-icon-10.png', label: 'list item 9', righttext: 'B', righticon2: '../../images/b-icon-2.png', righticon: '../../images/a-icon-1.png'}"></d-list-store-item>
		</d-list-store>
	</d-list>
	<div style="height: 350px;">
	</div>
	<div style="border-top: 1px white; position: fixed; bottom: 0px; z-index: 10; background: #c5ccd3; width: 100%">
		<table style="width: 100%;">
			<tr style="width: 100%;">
				<td><h3>Add / Remove elements in list stores:</h3></td>
				<td align=right><button onclick="document.getElementById('functionPanel').style.display = (this.innerHTML === 'Hide panel' ? 'none' : 'block'); this.innerHTML = (this.innerHTML === 'Hide panel' ? 'Show panel' : 'Hide panel');">Hide panel</button></td>
			</tr>
		<table id="functionPanel">
			<tr>
				<td>List id:</td>
				<td>
					<select id="listId">
						<option value="list-prog-1">list-prog-1</option>
						<option value="list-prog-2">list-prog-2</option>
						<option value="list-prog-3">list-prog-3</option>
						<option value="list-prog-4">list-prog-4</option>
						<option value="list-prog-5">list-prog-5</option>
						<option value="list-mark-1">list-mark-1</option>
						<option value="list-mark-2">list-mark-2</option>
						<option value="list-mark-3">list-mark-3</option>
						<option value="list-mark-4">list-mark-4</option>
					</select>
				</td>
			</tr>
			<tr>
				<td>New item label / right text (category):</td><td><input id="labelInput" type="text" value="new item A"> / <input id="righttextInput" type="text" value="Category 1"></td>
			</tr>
			<tr>
				<td>Index:</td><td><input id="indexInput" type="number"></td>
			</tr>
			<tr>
				<td></td><td><button id="addButton">add item to List.store (at index)</button></td>
			</tr>
			<tr>
				<td></td><td><button id="removeButton">remove item at index from List.store</button></td>
			</tr>
		</table>
	</div>
</body>
</html>
